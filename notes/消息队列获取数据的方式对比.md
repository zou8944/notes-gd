## 明确概念

### 长连接

TCP本身没有长短连接的概念，全在于我们如何使用它。开启连接 - 数据传送完成 - 关闭连接，这样可以叫做短链接；开启连接 - 传送数据 - 数据传输完成不关闭连接继续等待，这样可以叫做长连接。

HTTP的Keep-Alive有时也叫长连接，但这里的长连接只是为了连接复用，省去了握手环节。

TCP按照长连接使用时有一个最大的问题：保活，因为链路不稳定，可能连接已经断开了，但操作系统没有察觉到。常见的方式就是客户端和服务端向对方发送心跳。维持该长连接。

TCP长连接还有一个好处就是可以实现双向通信。

## 阿里云MNS

阿里云MNS是一个提供HTTP API的消息服务，无论发送消息还是拉取消息，都是走HTTP接口，即使是订阅主题，也是通过MNS服务端回调指定的url或mns实现的。

### 为什么MNS不能实现RabbitMQ那样的无痛订阅

还是因为HTTP本身就是一个无状态的被动的协议。

### 阿里云Kafka在订阅上是如何做的



## RabbitMQ

RabbitMQ是AMQP协议的实现，该协议是客户端-服务端的双向RPC协议，在消费消息时使用Basic.Consume命令。

而双向通信需要客户端定期发送心跳帧保持于服务端的连接。

AMQP信道本身就是对一个TCP连接复用的体现，一个TCP连接来回多次交换消息，使用了TCP长连接的特性。而长连接+心跳帧也让AMQP有了双向RPC通信的能力。

## RocketMQ



觉得写的不错的Kafka和RabbitMQ的区别的文章

https://www.cnblogs.com/haolujun/p/9632835.html