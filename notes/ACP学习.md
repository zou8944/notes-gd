

# VPC

## 为什么要有VPC？

- VLAN级别隔离，VPC之间安全隔离
- VPC内地址随意分配
- VPC与本地IDC，其它VPC也能方便连接。

### VPC特点

- 安全隔离

  - 隧道技术，达到传统VLAN级别隔离
  - 实现了云服务器之间的二层网络隔离，网卡mac信息不进入物理网络
  - VPC内的ECS可使用安全组进行三层网络隔离

  即VPC之间能够彻底隔离；VPC内达到网卡级别隔离。

- 访问控制

  - 灵活的访问控制

- 软件定义网络

  - 交换机、路由表的配置均由软件配置，实时生效。

- 丰富的网络连接

  - VPC之间
  - VPC与IDC之间
  - VPC与其它网络之间都能自由连接

## 网络基础

OSI以太网7层协议

![img](https://images2015.cnblogs.com/blog/705728/201604/705728-20160424234824085-667046040.png)

TCP/IP五层模型

![img](https://images2015.cnblogs.com/blog/705728/201604/705728-20160424234826351-1957282396.png)

- 应用层：HTTP、TELNET、SMTP、FTP
- 传输层：TCP、UDP、DNS
- 网络层：ICMP、IP。对应设备：路由器、三层交换机
- 数据链路层：ARP、RARP
- 物理层：双绞线。对应设备：中继器、二层交换机、网卡等（网卡也属于数据链路层）

### 路由器和二层交换机区别

- 路由器工作在3层
  - 通过IP寻址，支持TCP/IP协议
  - 因此支持子网划分
  - 可以跨网段连接不同设备
- 二层交换机工作在2层
  - 通过MAC地址寻址
  - 因此不支持子网划分
  - 只能在同一网段内进行数据交换

### 路由器和网关的区别

- 网关是逻辑概念。是连接两个网络的关卡。
- 路由器是物理设备。
- 网关可以由路由器实现；也可以由局域网中具有双网卡的机器来实现。

### VLAN

- Virtual Local Area Network，虚拟局域网

- 是一组逻辑上的设备和用户，并不受物理位置上的限制，仅根据逻辑需要将它们组织起来，它们之间的通信就像在一个网段中一样。因此叫做虚拟局域网。

  也就是说，属于不同交换机下的两个设备，可以属于同一个VLAN；同一交换机下的两个设备，也可以属于不同的VLAN。

- VLAN默认二层连通，三层通过对数据包封装VLAN_ID进行隔离。

- VLAN之间需要借助网关实现通信。

- VLAN优点

  - 端口隔离：一台交换机下划分多个VLAN，能够实现交换机的最大化利用
  - 提高安全：含有敏感数据的用户组可以与网络其余部分隔离
  - 管理灵活：部分地域，自由组合

## VPC

### 隔离原理

VPC基于隧道技术，每个VPC都有一个独立的隧道ID，一个隧道ID对应一个VPC。VPC云实例之间的数据传输包都会加上隧道ID，然后送到物理网络上进行传输。不同VPC内的资源会因为隧道ID不同，本身处于两个不同的路由平面，所以不同的VPC内的云产品资源无法通信，天然地进行了隔离。

### 重要名词解释

- 高速通道：实现任意地域内两个VPC之间的私网通信，避免绕行公网带来的坏处。
- 专线接入：VPC与线下IDC的数据互通，是高速通道的一个类型。

# ECS 

## 弹性

ECS的特点就是弹性。支持水平方向和垂直方向上的弹性。

弹性就是快速变更。

## BGP是什么意思？



## 可用区

可用区之间电力和网络独立，软件隔离的物理数据中心。可用区之间通过内网连接。

- 同一可用区内访问延迟最低，可用区之间稍高，region之间延迟最高，因为走公网了。

- 资源放在同一可用区缺点：可靠性不高，一个可用区挂了就完了。
- 磁盘只能挂载在同一可用区的ECS实例下
- 安全组允许跨可用区实例
- 快照和镜像可跨可用区，即region内可见
- 实例的故障转移只能在可用区内

![image-20201125233114154](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201125233114154.png)

## 故障迁移

宕机故障迁移仅针对使用云盘的ECS实例。如果是使用本次告诉磁盘的ECS实例，是需要提工单找回数据的。

## 存储

![image-20201126221139305](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201126221139305.png)

### 单独购买磁盘

单独购买的磁盘只能挂载到同一可用区内的ECS实例上，且同时只能挂载一个。

### 共享块存储

共享块存储，可以同时挂载到多个ECS实例上，最多16个。

### 本地存储

本地存储，是真的在ECS服务器上挂载了一块物理存储。支持NVME SSD和SATA HDD两种。

特点

- 超低延迟
- 低可靠性

不建议在本地存储存储需要长期保存的数据。

- 本地盘的生命周期和ECS实例生命周期强绑定
- 本地盘只能随着ECS创建和删除，而无法单独购买。且存储容量与实例规格有关，无法自行添加或减少。

### 其它

- 阿里云的块存储都是基于阿里的盘古分布式文件系统

## 快照

- 快照是使用增量的方式。只拷贝两个快照之间有数据变化的部分。因此第一次快照最快。

- 快照照的是系统还是磁盘

  答：

### 镜像

### 自定义镜像

- 是根据现有的服务器创建的自定义镜像

- 可以是根据现有ECS创建的，也可以是线下环境导入到ECS的

- 自定义镜像是ECS实例系统盘某一时刻的快照

- 用途

  - 大规模复制同样的云服务器时
  - 线下环境向线上环境迁移

- 注意事项

  - 做镜像时最好umount所有数据盘，因为新的ECS上很可能没有这些盘，到时候会无法启动。

  - 自定义镜像是地域级的东西，无法跨地域使用。即深圳创建的镜像只能在深圳使用，无法在杭州使用。

    但自定义镜像支持跨地域复制，复制之后就可以在该地域使用了。

## 网络

### 专有网络和经典网络的区别

![image-20201126224831974](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201126224831974.png)

### IO优化和非IO优化

- 非IO优化的实例为千兆共享带宽
- IO优化的实例为万兆共享带宽
- 这个千兆万兆指的是内网带宽，是同一地域可用区之间的
- 因此在同一地域内，推荐使用内网传输
- IO优化有一个优点：挂载SSD磁盘时候能够发挥速度

![image-20201126225324879](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201126225324879.png)

## 安全组

- 一个实例至少加入一个安全组
- 安全组是一种虚拟防火墙
- 安全组规则执行顺序
  - 优先级数字越小，越先
  - 如果优先级相同，则前面的先
  - 有多个安全组时，先看优先级，优先级相同时候安全组排在前面的先执行

## 操作

- fdisk用于分区
- mount用于挂载
- e2fsck检查文件系统

# SLB

## 特点

- 高可用
  - 全冗余涉及，无单点故障，支持同城容灾
- 低成本
  - 私网类型的SLB实例可以免费使用
- 安全
  - 结合云盾防DDos系统

## SLB如何容灾

	- 本地容灾 —— 即单个SLB对应多个后台服务
	- 同城容灾 —— 同区域，不同可用区设置多个SLB实例，通过DNS轮询的方式将流量打到多个SLB实例，即使一个SLB挂了也没关系
	- 跨区域容灾——不同区域设置多个SLB实例，通过DNS轮询的方式达到多个SLB实例

## 基础架构

![image-20201128113346661](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201128113346661.png)

## 主要功能

![image-20201128113448508](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201128113448508.png)

![image-20201128113616127](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201128113616127.png)

## 付费

![image-20201128113853573](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201128113853573.png)

- 公网流量算出不算入

## SLB妙用

- ECS带宽固定，而SLB带宽可调。可以在ECS前挂一个SLB，用以动态调整带宽。
- 把SLB中的后端服务权重设置为0时和移除ECS的区别
  - 设置为0后原来在ECS上的连接还会存在。直接移除ECS会导致之前的连接断掉。



## 阿里云的安全防护层有哪些？

## SLB提供多大程度的抗DDos攻击能力?

# api.aliyun.com

