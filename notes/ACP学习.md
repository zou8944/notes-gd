

# VPC

## 为什么要有VPC？

- VLAN级别隔离，VPC之间安全隔离
- VPC内地址随意分配
- VPC与本地IDC，其它VPC也能方便连接。

### VPC特点

- 安全隔离

  - 隧道技术，达到传统VLAN级别隔离
  - 实现了云服务器之间的二层网络隔离，网卡mac信息不进入物理网络
  - VPC内的ECS可使用安全组进行三层网络隔离

  即VPC之间能够彻底隔离；VPC内达到网卡级别隔离。

- 访问控制

  - 灵活的访问控制

- 软件定义网络

  - 交换机、路由表的配置均由软件配置，实时生效。

- 丰富的网络连接

  - VPC之间
  - VPC与IDC之间
  - VPC与其它网络之间都能自由连接

## 网络基础

OSI以太网7层协议

![img](https://images2015.cnblogs.com/blog/705728/201604/705728-20160424234824085-667046040.png)

TCP/IP五层模型

![img](https://images2015.cnblogs.com/blog/705728/201604/705728-20160424234826351-1957282396.png)

- 应用层：HTTP、TELNET、SMTP、FTP
- 传输层：TCP、UDP、DNS
- 网络层：ICMP、IP。对应设备：路由器、三层交换机
- 数据链路层：ARP、RARP
- 物理层：双绞线。对应设备：中继器、二层交换机、网卡等（网卡也属于数据链路层）

### 路由器和二层交换机区别

- 路由器工作在3层
  - 通过IP寻址，支持TCP/IP协议
  - 因此支持子网划分
  - 可以跨网段连接不同设备
- 二层交换机工作在2层
  - 通过MAC地址寻址
  - 因此不支持子网划分
  - 只能在同一网段内进行数据交换

### 路由器和网关的区别

- 网关是逻辑概念。是连接两个网络的关卡。
- 路由器是物理设备。
- 网关可以由路由器实现；也可以由局域网中具有双网卡的机器来实现。

### VLAN

- Virtual Local Area Network，虚拟局域网

- 是一组逻辑上的设备和用户，并不受物理位置上的限制，仅根据逻辑需要将它们组织起来，它们之间的通信就像在一个网段中一样。因此叫做虚拟局域网。

  也就是说，属于不同交换机下的两个设备，可以属于同一个VLAN；同一交换机下的两个设备，也可以属于不同的VLAN。

- VLAN默认二层连通，三层通过对数据包封装VLAN_ID进行隔离。

- VLAN之间需要借助网关实现通信。

- VLAN优点

  - 端口隔离：一台交换机下划分多个VLAN，能够实现交换机的最大化利用
  - 提高安全：含有敏感数据的用户组可以与网络其余部分隔离
  - 管理灵活：部分地域，自由组合

## VPC

### 隔离原理

VPC基于隧道技术，每个VPC都有一个独立的隧道ID，一个隧道ID对应一个VPC。VPC云实例之间的数据传输包都会加上隧道ID，然后送到物理网络上进行传输。不同VPC内的资源会因为隧道ID不同，本身处于两个不同的路由平面，所以不同的VPC内的云产品资源无法通信，天然地进行了隔离。

### 重要名词解释

- 高速通道：实现任意地域内两个VPC之间的私网通信，避免绕行公网带来的坏处。
- 专线接入：VPC与线下IDC的数据互通，是高速通道的一个类型。

# ECS 

## 弹性

ECS的特点就是弹性。支持水平方向和垂直方向上的弹性。

弹性就是快速变更。

## BGP是什么意思？



## 可用区

可用区之间电力和网络独立，软件隔离的物理数据中心。可用区之间通过内网连接。

- 同一可用区内访问延迟最低，可用区之间稍高，region之间延迟最高，因为走公网了。

- 资源放在同一可用区缺点：可靠性不高，一个可用区挂了就完了。
- 磁盘只能挂载在同一可用区的ECS实例下
- 安全组允许跨可用区实例
- 快照和镜像可跨可用区，即region内可见
- 实例的故障转移只能在可用区内

![image-20201125233114154](D:\WorkSpace\notes-gd\notes\ACP学习.assets\image-20201125233114154.png)

## 故障迁移

宕机故障迁移仅针对使用云盘的ECS实例。如果是使用本次告诉磁盘的ECS实例，是需要提工单找回数据的。

